<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Pip3line - The Swiss army knife of byte manipulation</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Pip3line</h1>
        
        <ul>
          <li class="download"><a class="buttons" href="index.html">Home</a></li>
          <li class="download"><a class="buttonsdownload" href="download.html">Download</a></li>
        </ul>
        <p class="header">Documentation</p>
        <ul>
          <li class="download"><a class="buttons" href="screenshots.html">Screenshots</a></li>
          <li class="download"><a class="buttons" href="nativeextensions.html">Native plugins</a></li>
          <li class="download"><a class="buttons" href="pythonplugins.html">Python plugins</a></li>
	  <li class="download"><a class="buttons" href="burpplugin.html">Burp plugin</a></li>
          <li class="download"><a class="buttons" href="shortcuts.html">Shortcuts list</a></li>
        </ul>
        <p class="header">Repository</p>
        <ul>
          <li><a class="buttons github" href="https://github.com/nccgroup/pip3line" target="_blank">View On GitHub</a></li>
        </ul>
        <p class="header">This project is maintained by <a class="header name" href="https://github.com/metrodango">Gabriel Caudrelier</a></p>


      </header>
      <section>
	<h2>Python 2.7 &amp; 3 plugins</h2>

	<h3>Prequisites</h3>
	<p><strong>The two Python plugins need respectively the Python 2.7 and Python 3.x libraries to be installed, if the plugin cannot found them, it will fail to load.</strong></p>

	<p>
	The Python 3 plugin is now using Python 3.3, although it works fine with 3.2.</p>
	<p>
	On Windows there is no real change to do, as the Python header is generic.<br/>
	On Linux platform the plugin is just a question of changing the headers value from 3.3 to 3.2 in the Python plugin code.
	</p>
	<h3>Files locations</h3>

	<p>The plugins looks for python files in the following locations</p>

        <h4>python 2.7</h4>
        <ul>
         <li>$HOME/.pip3line/python27</li>
         <li>$APP_DIR/plugins/python27</li>
         <li>$PREFIX/share/pip3line/python27 (UNIX only)</li>
        </ul>

        <h4>python 3</h4>
        <ul>
         <li>$HOME/.pip3line/python3</li>
         <li>$APP_DIR/plugins/python3</li>
         <li>$PREFIX/share/pip3line/python3 (UNIX only)</li>
        </ul>
        <p>They will load every Python files found and register them into the transformation list based on their file name.</p>

        <p>Additionally you can add your own files outside these directories, and make them "persistent" within Pip3line. See the transformation called "Python script 2.7/3" for this.</p>

        <h3>A few notes on the Python interpreters states and the module reload feature</h3>
	<p>Both plugins load and initialize one and only one python interpreter, so there are two loaded in memory if both plugins are loaded properly.
	</p>
	<p>The auto-reload feature will reinitialise the loaded module every time a transformation is applied, so in this case there can be no persistence
	in the module data</p>

	<img class="screenshots" src="images/pythonautoreload.png">
	<p>However if the auto-reload feature is disable the plugin module will be able to keep data accross transformation, but be aware that this applies to all instances of the same module.</p>
        <h3>The Code</h3>
        <p>It is relatively simple, as shown in the <em>extras</em> directory.</p>

        <p>You just need to implement the function <strong>pip3line_transform</strong> somewhere:</p>

	<pre><code>#!/usr/bin/env python
#-*- coding: UTF-8 -*-

def pip3line_transform(inputData):
	""" Take a bytearray as input and returns a bytearray"""
	# if you need to convert to a Python 'string'
	string = inputData.decode('utf-8')

	# Some code ......

	# just remember to convert it back to a bytearray
	return bytearray(string, 'utf-8')</code></pre>

	<p>If you want to implement a bi-directional transformation set the <strong>Pip3line_is_two_ways</strong> to true</p>
	<p>Then check the <strong>Pip3line_INBOUND</strong> value </p>
	
	<p>Use the gzip and bz2 examples as a starting point:</p>

	<pre><code>#!/usr/bin/env python3
#-*- coding: UTF-8 -*-

import gzip

Pip3line_is_two_ways = True

def pip3line_transform(inputData):
	ret = None
	if (Pip3line_INBOUND):
		ret = bytearray(gzip.compress(inputData))
	else:
		ret = bytearray(gzip.decompress(inputData))
	return ret</code></pre>

	<h3>Taking parameters from the gui</h3>
	<p>You can also send parameters to the scripts via the gui setting tab which are accessible as a Python dictionary <strong>Pip3line_params</strong></p>
	<p>you can define default parameters names by filling the <strong>Pip3line_params_names</strong> string list</p>
	<pre><code>Pip3line_params_names = ["param1", "param2"]</pre></code>
	<p>
	They are then accessible in the gui in the settings tab:
	</p>
	<img class="screenshots" src="images/python_params.png">
	<p>
	The transformation can then access the values via normal dictionary access
	</p>
	<pre><code>Pip3line_params["param1"]
Pip3line_params["param2"]</code></pre>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> based on the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
